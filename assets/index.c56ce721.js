import{d as H,b as Q,u as W,t as X,c as Y,a as Z,r as y,o as ee,f as _,g as f,h as S,k as u,i as l,j as a,F as ne,n as p,C as h,H as g,x as te,a3 as A,A as se,B as ie,a4 as R,q as E}from"./index.18c8bd69.js";const oe={class:"center_head"},le=u("span",{class:"title_font"},"\u56E2\u961F\u6587\u6863\u4E2D\u5FC3",-1),ue=u("span",{class:"btn_font"},"\u5BFC\u51FA\u6587\u6863",-1),re=u("span",{class:"btn_font"},"\u66F4\u591A\u6A21\u677F",-1),ae={class:"center_mid"},ce={class:"center_edit"},de={class:"center_menu"},pe={class:"custom-tree-container"},_e=["onMouseleave","onMouseenter"],ge={key:0,style:{padding:"0",margin:"0",position:"relative"}},ve={style:{position:"absolute",right:"0px"}},fe={class:"add_btn"},he=u("span",{class:"add_btn_font"},"+ \u8BBE\u8BA1\u9879\u76EE\u6587\u6863\u533A",-1),me=E(" \u53D6\u6D88 "),De=E("\u786E\u5B9A"),we=H({setup(ye){const C=Q(),P=W(),N=X(),x=Y(),M=Z(),B=y(!1),U=y(""),w=y(""),b=y("");let k={id:-1,name:""};const T=(e,s,i)=>{console.log(e,s,i),!e.isDir&&k.id!=e.id&&(k.id=e.id,k.name=e.label,P.name==="docCContent"?N.push({name:"docCContent0",params:k}):N.push({name:"docCContent",params:k}))};ee(()=>{j()});const j=()=>{_({url:_.defaults.baseURL+"/doc/get_doc_files",method:"post",headers:{"Content-Type":"application/json",Authorization:x.token},data:{group_id:M.id},transformRequest:[function(e,s){return JSON.stringify(e)}]}).then(function(e){var s;for(;c.value.length!=0;)c.value.pop();if(console.log("responseDoc",e.data),(s=e.data)!=null&&s.success){let t=e.data.file;console.log("root",t);let o=z(t);console.log(o),o.isRoot=!0,c.value.push(o)}})},z=(e,s=!1,i=0)=>{var d;let t={id:-1,label:"",name:"tre",children:null,isDir:!1,level:0,show:!1};t.id=e.file_id,t.label=e.file_name,t.isDir=e.is_dir==1,t.inputingDir=!1,t.inputingDoc=!1,t.renaming=!1,t.isProj=!1,t.isRoot=!1,t.level=i;let o=!1;if((e.file_name=="\u9879\u76EE\u6587\u6863\u533A"||s)&&(t.isProj=!0,o=!0),e!=null&&(t.children=[],e.contained_files!=null))for(let v=0;v<((d=e.contained_files)==null?void 0:d.length);v++)t.children.push(z(e.contained_files[v],o,i+1));return t},F=y(""),$=e=>{e.label=F.value,e.renaming=!1,console.log("data",e),_({url:_.defaults.baseURL+"/doc/update_document",method:"post",headers:{"Content-Type":"application/json",Authorization:x.token},data:{document_name:F.value,document_id:e.id},transformRequest:[function(s,i){return JSON.stringify(s)}]}).then(function(s){var i,t;console.log("addDIR",s),(i=s.data)!=null&&i.success&&(e.children!=null&&(c.value=[...c.value]),C.success((t=s.data)==null?void 0:t.message))})},K=e=>{e.inputingDoc=!1;const s={inputingDir:!1,inputingDoc:!1,renaming:!1,isProj:e.isProj,level:e.level+1,isRoot:!1,show:!1,id:-1,label:b.value,children:[],isDir:!1};e.children||(e.children=[]),_({url:_.defaults.baseURL+"/doc/create_doc_file",method:"post",headers:{"Content-Type":"application/json",Authorization:x.token},data:{file_name:b.value,dir_id:e.id,is_dir:0},transformRequest:[function(i,t){return JSON.stringify(i)}]}).then(function(i){var t,o;b.value="",console.log("addDIR",i),(t=i.data)!=null&&t.success&&(e.children!=null&&e.children.push(s),c.value=[...c.value],C.success((o=i.data)==null?void 0:o.message),j())})},q=e=>{e.inputingDoc=!0},I=e=>{e.inputingDir=!1;const s={inputingDir:!1,inputingDoc:!1,renaming:!1,isProj:e.isProj,level:e.level+1,isRoot:!1,show:!1,id:-1,label:w.value,children:[],isDir:!0};e.children||(e.children=[]),_({url:_.defaults.baseURL+"/doc/create_doc_file",method:"post",headers:{"Content-Type":"application/json",Authorization:x.token},data:{file_name:w.value,dir_id:e.id,is_dir:1},transformRequest:[function(i,t){return JSON.stringify(i)}]}).then(function(i){var t,o;console.log("addDIR",i),(t=i.data)!=null&&t.success&&(w.value="",e.children!=null&&e.children.push(s),c.value=[...c.value],C.success((o=i.data)==null?void 0:o.message),j())})},J=e=>{e.inputingDir=!0},L=(e,s)=>{console.log("data",s,"node",e);const i=e.parent,t=i.data.children||i.data,o=t.findIndex(d=>d.id===s.id);t.splice(o,1),c.value=[...c.value],_({url:_.defaults.baseURL+"/doc/move_document_to_bin",method:"post",headers:{"Content-Type":"application/json",Authorization:x.token},data:{document_id:s.id},transformRequest:[function(d,v){return JSON.stringify(d)}]}).then(function(d){var v,m;console.log("addDIR",d),(v=d.data)!=null&&v.success&&C.success((m=d.data)==null?void 0:m.message)})},c=y([]);return(e,s)=>{const i=f("n-gi"),t=f("n-image"),o=f("n-button"),d=f("n-grid"),v=f("router-view"),m=f("n-input"),O=f("el-tree"),V=f("n-space"),G=f("n-modal");return p(),S(ne,null,[u("div",oe,[l(d,{"x-gap":"12",cols:16},{default:a(()=>[l(i,{span:"1"}),l(i,{span:"5"},{default:a(()=>[l(t,{src:"svg\\center_svg\\title_img.svg"}),le]),_:1}),l(i,{span:"3"}),l(i,{span:"1"},{default:a(()=>[l(o,{color:"#2772F0","text-color":"#FFFFFF",style:{width:"130px",height:"46px","border-radius":"16px"}},{default:a(()=>[l(t,{src:"svg\\center_svg\\export.svg"}),ue]),_:1})]),_:1}),l(i,{span:"1"}),l(i,{span:"1"},{default:a(()=>[l(o,{color:"#2772F0","text-color":"#FFFFFF",style:{width:"130px",height:"46px","border-radius":"16px"}},{default:a(()=>[l(t,{src:"svg\\center_svg\\more.svg"}),re]),_:1})]),_:1})]),_:1})]),u("div",ae,[u("div",ce,[l(v)]),u("div",de,[l(V,{vertical:"",size:12},{default:a(()=>[u("div",pe,[l(O,{"highlight-current":"true",onNodeClick:T,draggable:"",data:c.value,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},{default:a(({node:D,data:n})=>[u("span",{class:"custom-tree-node",onMouseleave:r=>n.show=!!(n.inputingDoc||n.inputingDir||n.renaming),onMouseenter:r=>n.show=!0},[u("div",null,[n.isDir?g("",!0):(p(),h(t,{key:0,"preview-disabled":"",src:"svg\\doc\\documents.svg",style:{padding:"0",margin:"0"}})),n.isDir?(p(),h(t,{key:1,"preview-disabled":"",src:"svg\\doc\\doc.svg",style:{padding:"0",margin:"0"}})):g("",!0)]),n.renaming?g("",!0):(p(),S("span",ge,te(D.label),1)),n.renaming?(p(),h(m,{key:1,onKeyup:A(r=>$(n),["enter"]),value:F.value,"onUpdate:value":s[0]||(s[0]=r=>F.value=r),size:"small"},null,8,["onKeyup","value"])):g("",!0),se(u("span",ve,[!n.inputingDir&&!n.inputingDoc&&!n.renaming&&!n.isProj&&n.isDir?(p(),h(t,{key:0,"preview-disabled":"",onClick:R(r=>J(n),["stop"]),src:"svg\\doc\\dir+.svg",style:{width:"18px",height:"18px","margin-left":"2px"}},null,8,["onClick"])):g("",!0),n.inputingDir?(p(),h(m,{key:1,value:w.value,"onUpdate:value":s[1]||(s[1]=r=>w.value=r),onKeyup:A(r=>I(n),["enter"]),size:"small"},null,8,["value","onKeyup"])):g("",!0),n.isDir&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),h(t,{key:2,"preview-disabled":"",onClick:R(r=>q(n),["stop"]),src:"svg\\doc\\doc+.svg",style:{width:"18px",height:"18px","margin-left":"2px"}},null,8,["onClick"])):g("",!0),n.inputingDoc?(p(),h(m,{key:3,value:b.value,"onUpdate:value":s[2]||(s[2]=r=>b.value=r),onKeyup:A(r=>K(n),["enter"]),size:"small"},null,8,["value","onKeyup"])):g("",!0),!(n.isProj&&n.isDir&&(n.level==1||n.level==2))&&!n.isRoot&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),h(t,{key:4,"preview-disabled":"",onClick:R(()=>{n.renaming=!0},["stop"]),src:"svg\\doc\\rename.svg",style:{width:"17px",height:"17px","margin-left":"2px"}},null,8,["onClick"])):g("",!0),!(n.isProj&&n.isDir&&(n.level==1||n.level==2))&&!n.isRoot&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),h(t,{key:5,"preview-disabled":"",onClick:R(r=>L(D,n),["stop"]),width:"20",src:"svg\\doc\\trash.svg",style:{width:"17px",height:"17px","margin-left":"2px"}},null,8,["onClick"])):g("",!0)],512),[[ie,n.show]])],40,_e)]),_:1},8,["data"])])]),_:1})]),u("div",fe,[l(o,{color:"rgba(39, 114, 240, 0.09)","text-color":"#2772F0",style:{position:"absolute",width:"169px",height:"32px","border-radius":"20px"}},{default:a(()=>[he]),_:1})])]),u("div",null,[l(G,{show:B.value,"onUpdate:show":s[4]||(s[4]=D=>B.value=D),style:{width:"500px"},class:"custom-card",preset:"card",title:" \u8BF7\u8F93\u5165\u6587\u6863\u540D\u5B57",size:"huge",bordered:!1},{"header-extra":a(()=>[me]),footer:a(()=>[l(o,null,{default:a(()=>[De]),_:1})]),default:a(()=>[l(m,{value:U.value,"onUpdate:value":s[3]||(s[3]=D=>U.value=D)},null,8,["value"])]),_:1},8,["show"])])],64)}}});export{we as default};
