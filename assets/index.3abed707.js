import{d as te,G as oe,b as se,u as le,t as ie,c as ue,a as ae,r as m,o as re,f as _,g,h as K,k as d,i as l,j as c,F as ce,n as p,C as D,H as f,x as de,a3 as M,A as pe,B as ve,a4 as j,q as O}from"./index.f1022d15.js";const _e={class:"center_head"},ge=d("span",{class:"title_font"},"\u56E2\u961F\u6587\u6863\u4E2D\u5FC3",-1),fe={class:"center_mid"},he={class:"center_edit"},me={class:"center_menu"},De={class:"custom-tree-container"},ye=["onMouseleave","onMouseenter"],we={key:0,style:{padding:"0",margin:"0",position:"relative"}},be={style:{position:"absolute",right:"0px"}},xe={class:"add_btn"},Ce=d("span",{class:"add_btn_font"},"+ \u8BBE\u8BA1\u9879\u76EE\u6587\u6863\u533A",-1),ke=O(" \u53D6\u6D88 "),Ae=O("\u786E\u5B9A"),Be=te({setup(Re){const A=oe(),R=se(),q=le(),S=ie(),y=ue(),I=ae(),P=m(!1),z=m(""),w=m(""),b=m(""),x=m(),F=m(null),N=m([]),J=[{label:"\u4F1A\u8BAE\u7EAA\u8981",value:"\u4F1A\u8BAE\u7EAA\u8981"},{label:"\u9879\u76EE\u89C4\u5212",value:"\u9879\u76EE\u89C4\u5212"},{label:"\u9700\u6C42\u6587\u6863",value:"\u9700\u6C42\u6587\u6863"}];N.value.push({label:"word",value:1}),N.value.push({label:"pdf",value:2});const L=()=>{console.log(x.value),Number(x.value)==1?A.Dopt="word":A.Dopt="pdf",x.value="\u5BFC\u51FA\u6587\u6863"},V=()=>{A.DMname=String(F.value),A.Dopt="load"};let C={id:-1,name:""};const G=(e,o,s)=>{console.log(e,o,s),!e.isDir&&C.id!=e.id&&(C.id=e.id,C.name=e.label,q.name==="docCContent"?S.push({name:"docCContent0",params:C}):S.push({name:"docCContent",params:C}))};re(()=>{U()});const U=()=>{_({url:_.defaults.baseURL+"/doc/get_doc_files",method:"post",headers:{"Content-Type":"application/json",Authorization:y.token},data:{group_id:I.id},transformRequest:[function(e,o){return JSON.stringify(e)}]}).then(function(e){var o;for(;r.value.length!=0;)r.value.pop();if(console.log("responseDoc",e.data),(o=e.data)!=null&&o.success){let t=e.data.file;console.log("root",t);let i=T(t);console.log(i),i.isRoot=!0,r.value.push(i)}})},T=(e,o=!1,s=0)=>{var u;let t={id:-1,label:"",name:"tre",children:null,isDir:!1,level:0,show:!1};t.id=e.file_id,t.label=e.file_name,t.isDir=e.is_dir==1,t.inputingDir=!1,t.inputingDoc=!1,t.renaming=!1,t.isProj=!1,t.isRoot=!1,t.level=s;let i=!1;if((e.file_name=="\u9879\u76EE\u6587\u6863\u533A"||o)&&(t.isProj=!0,i=!0),e!=null&&(t.children=[],e.contained_files!=null))for(let h=0;h<((u=e.contained_files)==null?void 0:u.length);h++)t.children.push(T(e.contained_files[h],i,s+1));return t},E=m(""),H=e=>{e.label=E.value,e.renaming=!1,console.log("data",e),_({url:_.defaults.baseURL+"/doc/update_document",method:"post",headers:{"Content-Type":"application/json",Authorization:y.token},data:{document_name:E.value,document_id:e.id},transformRequest:[function(o,s){return JSON.stringify(o)}]}).then(function(o){var s,t;console.log("addDIR",o),(s=o.data)!=null&&s.success&&(e.children!=null&&(r.value=[...r.value]),R.success((t=o.data)==null?void 0:t.message))})},Q=e=>{e.inputingDoc=!1;const o={inputingDir:!1,inputingDoc:!1,renaming:!1,isProj:e.isProj,level:e.level+1,isRoot:!1,show:!1,id:-1,label:b.value,children:[],isDir:!1};e.children||(e.children=[]),_({url:_.defaults.baseURL+"/doc/create_doc_file",method:"post",headers:{"Content-Type":"application/json",Authorization:y.token},data:{file_name:b.value,dir_id:e.id,is_dir:0},transformRequest:[function(s,t){return JSON.stringify(s)}]}).then(function(s){var t,i;b.value="",console.log("addDIR",s),(t=s.data)!=null&&t.success&&(e.children!=null&&e.children.push(o),r.value=[...r.value],R.success((i=s.data)==null?void 0:i.message),U())})},W=e=>{e.inputingDoc=!0},X=e=>{e.inputingDir=!1;const o={inputingDir:!1,inputingDoc:!1,renaming:!1,isProj:e.isProj,level:e.level+1,isRoot:!1,show:!1,id:-1,label:w.value,children:[],isDir:!0};e.children||(e.children=[]),_({url:_.defaults.baseURL+"/doc/create_doc_file",method:"post",headers:{"Content-Type":"application/json",Authorization:y.token},data:{file_name:w.value,dir_id:e.id,is_dir:1},transformRequest:[function(s,t){return JSON.stringify(s)}]}).then(function(s){var t,i;console.log("addDIR",s),(t=s.data)!=null&&t.success&&(w.value="",e.children!=null&&e.children.push(o),r.value=[...r.value],R.success((i=s.data)==null?void 0:i.message),U())})},Y=e=>{e.inputingDir=!0},Z=(e,o)=>{console.log("data",o,"node",e);const s=e.parent,t=s.data.children||s.data,i=t.findIndex(u=>u.id===o.id);t.splice(i,1),r.value=[...r.value],_({url:_.defaults.baseURL+"/doc/move_document_to_bin",method:"post",headers:{"Content-Type":"application/json",Authorization:y.token},data:{document_id:o.id},transformRequest:[function(u,h){return JSON.stringify(u)}]}).then(function(u){var h,k;console.log("addDIR",u),(h=u.data)!=null&&h.success&&R.success((k=u.data)==null?void 0:k.message)})},r=m([]);return(e,o)=>{const s=g("n-gi"),t=g("n-image"),i=g("n-select"),u=g("n-space"),h=g("n-grid"),k=g("router-view"),B=g("n-input"),ee=g("el-tree"),$=g("n-button"),ne=g("n-modal");return p(),K(ce,null,[d("div",_e,[l(h,{"x-gap":"12",cols:16},{default:c(()=>[l(s,{span:"1"}),l(s,{span:"5"},{default:c(()=>[l(t,{src:"svg\\center_svg\\title_img.svg"}),ge]),_:1}),l(s,{span:"3"}),l(s,{span:"2"},{default:c(()=>[l(u,{vertical:""},{default:c(()=>[l(i,{value:x.value,"onUpdate:value":[o[0]||(o[0]=v=>x.value=v),L],options:N.value,placeholder:"\u5BFC\u51FA\u6587\u6863",class:"choose selectP"},null,8,["value","options"])]),_:1})]),_:1}),l(s,{span:"2"},{default:c(()=>[l(i,{value:F.value,"onUpdate:value":[o[1]||(o[1]=v=>F.value=v),V],options:J,placeholder:"\u66F4\u591A\u6A21\u677F",class:"choose selectP"},null,8,["value"])]),_:1}),l(s),l(s,{span:"1"}),l(s,{span:"2"})]),_:1})]),d("div",fe,[d("div",he,[l(k)]),d("div",me,[l(u,{vertical:"",size:12},{default:c(()=>[d("div",De,[l(ee,{"highlight-current":"true",onNodeClick:G,draggable:"",data:r.value,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},{default:c(({node:v,data:n})=>[d("span",{class:"custom-tree-node",onMouseleave:a=>n.show=!!(n.inputingDoc||n.inputingDir||n.renaming),onMouseenter:a=>n.show=!0},[d("div",null,[n.isDir?f("",!0):(p(),D(t,{key:0,"preview-disabled":"",src:"svg\\doc\\documents.svg",style:{padding:"0",margin:"0"}})),n.isDir?(p(),D(t,{key:1,"preview-disabled":"",src:"svg\\doc\\doc.svg",style:{padding:"0",margin:"0"}})):f("",!0)]),n.renaming?f("",!0):(p(),K("span",we,de(v.label),1)),n.renaming?(p(),D(B,{key:1,onKeyup:M(a=>H(n),["enter"]),value:E.value,"onUpdate:value":o[2]||(o[2]=a=>E.value=a),size:"small"},null,8,["onKeyup","value"])):f("",!0),pe(d("span",be,[!n.inputingDir&&!n.inputingDoc&&!n.renaming&&!n.isProj&&n.isDir?(p(),D(t,{key:0,"preview-disabled":"",onClick:j(a=>Y(n),["stop"]),src:"svg\\doc\\dir+.svg",style:{width:"18px",height:"18px","margin-left":"2px"}},null,8,["onClick"])):f("",!0),n.inputingDir?(p(),D(B,{key:1,value:w.value,"onUpdate:value":o[3]||(o[3]=a=>w.value=a),onKeyup:M(a=>X(n),["enter"]),size:"small"},null,8,["value","onKeyup"])):f("",!0),n.isDir&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),D(t,{key:2,"preview-disabled":"",onClick:j(a=>W(n),["stop"]),src:"svg\\doc\\doc+.svg",style:{width:"18px",height:"18px","margin-left":"2px"}},null,8,["onClick"])):f("",!0),n.inputingDoc?(p(),D(B,{key:3,value:b.value,"onUpdate:value":o[4]||(o[4]=a=>b.value=a),onKeyup:M(a=>Q(n),["enter"]),size:"small"},null,8,["value","onKeyup"])):f("",!0),!(n.isProj&&n.isDir&&(n.level==1||n.level==2))&&!n.isRoot&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),D(t,{key:4,"preview-disabled":"",onClick:j(()=>{n.renaming=!0},["stop"]),src:"svg\\doc\\rename.svg",style:{width:"17px",height:"17px","margin-left":"2px"}},null,8,["onClick"])):f("",!0),!(n.isProj&&n.isDir&&(n.level==1||n.level==2))&&!n.isRoot&&!n.inputingDir&&!n.inputingDoc&&!n.renaming?(p(),D(t,{key:5,"preview-disabled":"",onClick:j(a=>Z(v,n),["stop"]),width:"20",src:"svg\\doc\\trash.svg",style:{width:"17px",height:"17px","margin-left":"2px"}},null,8,["onClick"])):f("",!0)],512),[[ve,n.show]])],40,ye)]),_:1},8,["data"])])]),_:1})]),d("div",xe,[l($,{color:"rgba(39, 114, 240, 0.09)","text-color":"#2772F0",style:{position:"absolute",width:"169px",height:"32px","border-radius":"20px"}},{default:c(()=>[Ce]),_:1})])]),d("div",null,[l(ne,{show:P.value,"onUpdate:show":o[6]||(o[6]=v=>P.value=v),style:{width:"500px"},class:"custom-card",preset:"card",title:" \u8BF7\u8F93\u5165\u6587\u6863\u540D\u5B57",size:"huge",bordered:!1},{"header-extra":c(()=>[ke]),footer:c(()=>[l($,null,{default:c(()=>[Ae]),_:1})]),default:c(()=>[l(B,{value:z.value,"onUpdate:value":o[5]||(o[5]=v=>z.value=v)},null,8,["value"])]),_:1},8,["show"])])],64)}}});export{Be as default};
